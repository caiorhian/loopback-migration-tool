{"version":3,"sources":["utils.js"],"names":["appLoader","defs","ds","model","method","ignored_model","src","app","defaults","loadDefaults","appPath","isAbsolute","process","cwd","require","loopback","default","rcPath","newDefaults","existsSync","JSON","parse","readFileSync"],"mappings":"AAAA;AACA;;;;;;;;QAoBgBA,S,GAAAA,S;;AAjBhB;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMC,OAAO;AACTC,QAAI,EADK;AAETC,WAAO,EAFE;AAGTC,YAAQ,SAHC;AAITC,mBAAe,EAJN;AAKTC,SAAK,cALI;AAMTC,SAAK;AANI,CAAb,CASO,IAAIC,8BAAWC,aAAa,wBAAb,CAAf;;AAEA,SAAST,SAAT,CAAmBU,OAAnB,EAA4B;AAC/B,QAAI,CAAC,eAAKC,UAAL,CAAgBD,OAAhB,CAAL,EAA+B;AAC3BA,kBAAYE,QAAQC,GAAR,EAAZ,SAA6BH,OAA7B;AACH;AACD,QAAIH,MAAMO,QAAQJ,OAAR,CAAV;AACA,QAAI,CAACH,IAAIQ,QAAL,IAAiBR,IAAIS,OAArB,IAAgCT,IAAIS,OAAJ,CAAYD,QAAhD,EAA0D;AACtDR,cAAMA,IAAIS,OAAV;AACJ,WAAOT,GAAP;AACH;;AAED,SAASE,YAAT,CAAsBQ,MAAtB,EAA8B;AAC1B,QAAIC,cAAc,EAAlB;AACA,QAAI,aAAGC,UAAH,CAAcF,MAAd,CAAJ,EAA2B;AACvBC,sBAAcE,KAAKC,KAAL,CAAW,aAAGC,YAAH,CAAgBL,MAAhB,EAAwB,OAAxB,CAAX,CAAd;AACH;AACDC,kBAAc,iBAAEV,QAAF,CAAWU,WAAX,EAAwBjB,IAAxB,CAAd;AACA,WAAOiB,WAAP;AACH","file":"utils.js","sourcesContent":["\"use strict\"\n/**\n * Created by garusis on 01/02/17.\n */\nimport _ from \"lodash\"\nimport fs from \"fs\"\nimport path from \"path\"\nimport debug from \"debug\"\nimport yargs from \"yargs\"\n\nconst defs = {\n    ds: [],\n    model: [],\n    method: \"migrate\",\n    ignored_model: [],\n    src: \"./seeds/*.js\",\n    app: \"./server/server.js\"\n}\n\nexport let defaults = loadDefaults(\"./.lb-migrationrc.json\")\n\nexport function appLoader(appPath) {\n    if (!path.isAbsolute(appPath)) {\n        appPath= `${process.cwd()}/${appPath}`\n    }\n    let app = require(appPath)\n    if (!app.loopback && app.default && app.default.loopback) //exported as a ES6 module.\n        app = app.default\n    return app\n}\n\nfunction loadDefaults(rcPath) {\n    let newDefaults = {}\n    if (fs.existsSync(rcPath)) {\n        newDefaults = JSON.parse(fs.readFileSync(rcPath, \"utf-8\"))\n    }\n    newDefaults = _.defaults(newDefaults, defs)\n    return newDefaults\n}"],"sourceRoot":"./"}